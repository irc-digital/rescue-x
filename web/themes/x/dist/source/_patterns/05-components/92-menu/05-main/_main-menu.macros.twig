{% import _self as main_menu %}

{% macro build(items) %}
  {% import _self as main_menu %}

  <ul class="rplc-main-menu">
    {% for item in items %}
      {{ main_menu._build_leveL_1(item) }}
    {% endfor %}
  </ul>
{% endmacro %}


{% macro _build_leveL_1(item) %}
  {% import _self as main_menu %}

  <li class="rplc-main-menu__level-1-menu-item">
    <a class="rplc-main-menu__level-1-menu-item-link" href="{{ item.url }}">{{ item.title }}</a>

    {% if item.items is not empty %}
      <ul class="rplc-main-menu__level-2">
        {% for subitem in item.items %}
          {{ main_menu._build_leveL_2(subitem) }}
        {% endfor %}
      </ul>
    {% endif %}

  </li>

{% endmacro %}


{% macro _build_leveL_2(item) %}
  {% import _self as main_menu %}

  {% set has_level_4 = item.items is not empty and item.items[0].items is not empty %}

  <li class="rplc-main-menu__level-2-menu-item">
    <h5 class="rplc-main-menu__level-2-menu-item-title rplc-main-menu__level-2-menu-item-title--{% if has_level_4 %}hidden{% else %}shown{% endif %}">{{ item.title }}</h5>

    {% if item.items is not empty %}
      <ul class="rplc-main-menu__level-3">
        {% for subitem in item.items %}
          {{ main_menu._build_leveL_3(subitem) }}
        {% endfor %}
      </ul>
    {% endif %}

  </li>

{% endmacro %}

{% macro _build_leveL_3(item) %}
  {% import _self as main_menu %}

  <li class="rplc-main-menu__level-3-menu-item">
    <div class="rplc-main-menu__level-3-menu-item-title">{{ item.title }}</div>

    {% if item.items is not empty %}
      <ul class="rplc-main-menu__level-4">
        {% for subitem in item.items %}
          {{ main_menu._build_leveL_4(subitem) }}
        {% endfor %}
      </ul>
    {% endif %}
  </li>

{% endmacro %}

{% macro _build_leveL_4(item) %}
  <li class="rplc-main-menu__level-4-menu-item">
    {{ item.title }}
  </li>
{% endmacro %}
